---
title: 'Supplementary material and reproducible research files for article "*A joint Bayesian framework for missing data and measurement error using integrated nested Laplace approximations*"'
---

(Note: The article is not yet published.)

Authors: Skarstein, E., Martino, S., Muff, S.

This supplementary material was written by Skarstein, E., but code for analysis was developed jointly between authors.

In case of any questions or comments, please do not hesitate to contact <emma.s.skarstein@ntnu.no>!

This website contains scripts, tutorials and data to reproduce all analysis and figures from the manuscript.

## Examples 
These include scripts to run the code for analysis, including comments and explanations.

For a step-by-step introduction with detailed explanations, see [Simulation example](Simulation_example.qmd). This is a single sun of the simulation study shown in the paper, and the full code for the study can be found in [Simulation study](simulation_study.qmd). The data and model used in these examples reflect the most general case where we have a covariate with classical and Berkson measurement error, as well as missing data. For many users `inlabru` might be more intuitive than plain INLA, and so we have also included the same model implemented in `inlabru` in [Example in `inlabru`](example_in_inlabru.qmd).

The remaining examples are variations on the above model using different data sets, see the table below for an overview of the different types of ME in the different examples.

Example | Classical ME | Berkson ME | Missing data  
---|-------------|-------------|-------------
[Missing covariate imputation](missing_covariate_imputation.qmd) | | | x 
[Missing and mismeasured covariate](missing_and_mismeasured_covariate.qmd) | x | | x 
[Simulation study](simulation_study.qmd) | x | x | x 
[Simulation example](simulation_example.qmd) | x | x | x 
[Example in `inlabru`](example_in_inlabru.qmd) | x | x | x 


## Datasets
All the data sets that are used in the paper can be downloaded manually from [the GitHub repository](https://github.com/emmaSkarstein/Missing-data-and-measurement-error), or like this:

```{r}
library(RCurl)
url_bloodpressure <- getURL("https://raw.githubusercontent.com/emmaSkarstein/Missing-data-and-measurement-error/master/data/bloodpressure.csv")
bloodpressure <- read.csv(text = url_bloodpressure)

url_simulated_data <- getURL("https://raw.githubusercontent.com/emmaSkarstein/Missing-data-and-measurement-error/master/data/simulated_data.csv")
simulated_data <- read.csv(text = url_simulated_data)
```

## Session info

The code was written and run in R with the following software versions:
```{r}
#| echo: false
#| message: false
library(INLA)
```

```{r}
#| results: asis
inla.version()
```


```{r}
#| results: asis
#| echo: false
sessioninfo::session_info(pkgs = c("INLA", "inlabru")) |> 
  details::details(
    summary = 'Current session info',
    open    = TRUE
  )
```

